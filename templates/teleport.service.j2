[Unit]
Description=Teleport service
After=network.target
ConditionFileNotEmpty={{ teleport_config_path }}

[Service]
Type=simple
Restart=on-failure
RestartSec=3
ExecStart={{ teleport_bin_path }} start \
    --config {{ teleport_config_path }} \
    --pid-file=/var/run/teleport.pid \
    --diag-addr=127.0.0.1:3000
ExecReload=/bin/kill -HUP $MAINPID
PIDFile=/var/run/teleport.pid

[Install]
WantedBy=multi-user.target
